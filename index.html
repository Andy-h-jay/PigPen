<!DOCTYPE html>
<html><head><meta charset="UTF-8"><link href="css/default.css" rel="stylesheet" type="text/css"><script src="js/jquery.min.js" type="text/javascript"></script><script src="js/page_effects.js" type="text/javascript"></script><title>Pigpen 0.2.1-SNAPSHOT API documentation</title></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html">Pigpen 0.2.1-SNAPSHOT API documentation</a></h1></div><div class="sidebar" id="namespaces"><h3><span>Namespaces</span></h3><ul><li><a href="pigpen.core.html"><span>pigpen.core</span></a></li><li><a href="pigpen.fold.html"><span>pigpen.fold</span></a></li></ul></div><div class="namespace-index" id="content"><h2>Pigpen 0.2.1-SNAPSHOT API documentation</h2><div class="doc"></div><div class="namespace"><h3><a href="pigpen.core.html"><span>pigpen.core</span></a></h3><pre class="doc">Contains the operators for PigPen.
</pre><div class="index"><p>Public variables and functions:</p><ul><li><a href="pigpen.core.html#var-cogroup"><span>cogroup</span></a></li><li><a href="pigpen.core.html#var-concat"><span>concat</span></a></li><li><a href="pigpen.core.html#var-constantly"><span>constantly</span></a></li><li><a href="pigpen.core.html#var-difference"><span>difference</span></a></li><li><a href="pigpen.core.html#var-difference-multiset"><span>difference-multiset</span></a></li><li><a href="pigpen.core.html#var-distinct"><span>distinct</span></a></li><li><a href="pigpen.core.html#var-dump"><span>dump</span></a></li><li><a href="pigpen.core.html#var-dump%26show"><span>dump&amp;show</span></a></li><li><a href="pigpen.core.html#var-dump%26show%2B"><span>dump&amp;show+</span></a></li><li><a href="pigpen.core.html#var-dump-async"><span>dump-async</span></a></li><li><a href="pigpen.core.html#var-filter"><span>filter</span></a></li><li><a href="pigpen.core.html#var-fold"><span>fold</span></a></li><li><a href="pigpen.core.html#var-generate-script"><span>generate-script</span></a></li><li><a href="pigpen.core.html#var-group-by"><span>group-by</span></a></li><li><a href="pigpen.core.html#var-intersection"><span>intersection</span></a></li><li><a href="pigpen.core.html#var-intersection-multiset"><span>intersection-multiset</span></a></li><li><a href="pigpen.core.html#var-into"><span>into</span></a></li><li><a href="pigpen.core.html#var-join"><span>join</span></a></li><li><a href="pigpen.core.html#var-load-clj"><span>load-clj</span></a></li><li><a href="pigpen.core.html#var-load-lazy"><span>load-lazy</span></a></li><li><a href="pigpen.core.html#var-load-pig"><span>load-pig</span></a></li><li><a href="pigpen.core.html#var-load-tsv"><span>load-tsv</span></a></li><li><a href="pigpen.core.html#var-map"><span>map</span></a></li><li><a href="pigpen.core.html#var-map-indexed"><span>map-indexed</span></a></li><li><a href="pigpen.core.html#var-mapcat"><span>mapcat</span></a></li><li><a href="pigpen.core.html#var-reduce"><span>reduce</span></a></li><li><a href="pigpen.core.html#var-remove"><span>remove</span></a></li><li><a href="pigpen.core.html#var-return"><span>return</span></a></li><li><a href="pigpen.core.html#var-sample"><span>sample</span></a></li><li><a href="pigpen.core.html#var-script"><span>script</span></a></li><li><a href="pigpen.core.html#var-show"><span>show</span></a></li><li><a href="pigpen.core.html#var-show%2B"><span>show+</span></a></li><li><a href="pigpen.core.html#var-sort"><span>sort</span></a></li><li><a href="pigpen.core.html#var-sort-by"><span>sort-by</span></a></li><li><a href="pigpen.core.html#var-store-clj"><span>store-clj</span></a></li><li><a href="pigpen.core.html#var-store-pig"><span>store-pig</span></a></li><li><a href="pigpen.core.html#var-store-tsv"><span>store-tsv</span></a></li><li><a href="pigpen.core.html#var-take"><span>take</span></a></li><li><a href="pigpen.core.html#var-union"><span>union</span></a></li><li><a href="pigpen.core.html#var-union-multiset"><span>union-multiset</span></a></li><li><a href="pigpen.core.html#var-write-script"><span>write-script</span></a></li></ul></div></div><div class="namespace"><h3><a href="pigpen.fold.html"><span>pigpen.fold</span></a></h3><pre class="doc">Contains fold operations for use with pig/fold, pig/group-by, and pig/cogroup.
Each fold operation consists of 3 parts: pre-processing on the input values, a
parallel reduce, and post-processing on the output value.

Use pigpen.fold/fold-fn to create a fold function. The pre function is a
function that takes a sequence and returns a sequence. The combinef and reducef
functions are used to aggregate the collection. Calling (combinef) with no args
is used to produce a seed value. Then reducef is used to aggregate chunks of
data into intermediate products in parallel. Finally, combinef is optionally
called to combine intermediate products. An optional post function is called on
the final result. If combinef is not specified, reducef is used for both. The
pre and post functions default to identity.

The functions in pigpen.fold can be composed, but they must be composed in a
specific order. It must start with preprocessor functions, then a reducer, and
finally post-processing. The post-processing sequence operators can only be
used with reducer functions that produce seqs. See below for which is which.

For example, you can do this:

  (-&gt;&gt; (fold/map :foo) (fold/sort) (fold/take 40))

But you cannot do this:

  (-&gt;&gt; (pig/count) (pig/map :foo))

In the first example, there's an implicit (vec) operation to reduce the values
into a vector. It's actually doing this:

  (-&gt;&gt; (fold/map :foo) (fold/vec) (fold/sort) (fold/take 40))

The (vec) operation reduces into a vector, effectively not reducing the
collection, but instead just preserving it. This can be useful if you just want
to project a single value from a larger data structure. It uses conj and concat
to build the vector.

There are three places to use a fold operation. You can reduce the entire
dataset using pigpen.pig/fold:

  (pig/fold (fold/count) foos)

Or apply a fold to the groupings produced by pigpen.pig/group-by and
pigpen.pig/cogroup:

  (-&gt;&gt; foos
    (pig/group-by :foo
      {:fold (fold/count)})
    (pig/map (fn [key f] f)))

  (pig/cogroup [(foos :on :foo, :fold (fold/sum))
                (bars :on :bar, :fold (fold/avg))]
    (fn [key f b] [f b]))

In the last examples, f and b are both numerical values instead of the usual
sequences. If you need to perform multiple aggregations, fold/juxt is what you
need:

  (-&gt;&gt; foos
    (pig/group-by :foo
      {:fold (fold/juxt (fold/count) (fold/sum) (fold/avg))})
    (pig/map (fn [key [count sum avg]] ...)))

Pre-processing operations:

  map, mapcat, filter, remove, keep

Reduce operations:

  count, sum, avg, min, min-key, max, max-key, distinct, vec

Post-processing operations:

  first, last, sort, sort-by, take, top, top-by</pre><div class="index"><p>Public variables and functions:</p><ul><li><a href="pigpen.fold.html#var-avg"><span>avg</span></a></li><li><a href="pigpen.fold.html#var-count"><span>count</span></a></li><li><a href="pigpen.fold.html#var-distinct"><span>distinct</span></a></li><li><a href="pigpen.fold.html#var-filter"><span>filter</span></a></li><li><a href="pigpen.fold.html#var-first"><span>first</span></a></li><li><a href="pigpen.fold.html#var-fold-fn"><span>fold-fn</span></a></li><li><a href="pigpen.fold.html#var-juxt"><span>juxt</span></a></li><li><a href="pigpen.fold.html#var-keep"><span>keep</span></a></li><li><a href="pigpen.fold.html#var-last"><span>last</span></a></li><li><a href="pigpen.fold.html#var-map"><span>map</span></a></li><li><a href="pigpen.fold.html#var-mapcat"><span>mapcat</span></a></li><li><a href="pigpen.fold.html#var-max"><span>max</span></a></li><li><a href="pigpen.fold.html#var-max-key"><span>max-key</span></a></li><li><a href="pigpen.fold.html#var-min"><span>min</span></a></li><li><a href="pigpen.fold.html#var-min-key"><span>min-key</span></a></li><li><a href="pigpen.fold.html#var-preprocess"><span>preprocess</span></a></li><li><a href="pigpen.fold.html#var-remove"><span>remove</span></a></li><li><a href="pigpen.fold.html#var-sort"><span>sort</span></a></li><li><a href="pigpen.fold.html#var-sort-by"><span>sort-by</span></a></li><li><a href="pigpen.fold.html#var-sum"><span>sum</span></a></li><li><a href="pigpen.fold.html#var-take"><span>take</span></a></li><li><a href="pigpen.fold.html#var-top"><span>top</span></a></li><li><a href="pigpen.fold.html#var-top-by"><span>top-by</span></a></li><li><a href="pigpen.fold.html#var-vec"><span>vec</span></a></li></ul></div></div></div></body></html>